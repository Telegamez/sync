# CVE-2025-55182 (React2Shell) Remediation Report

**Date:** 2025-12-15
**Severity:** Critical (RCE)
**Status:** MITIGATED

---

## Vulnerability Overview

**CVE-2025-55182** (React2Shell) is a critical Remote Code Execution (RCE) vulnerability affecting:

- `react` versions 19.0.0 – 19.2.0
- `next` versions 15.x/16.x prior to patch

The vulnerability allows remote attackers to execute arbitrary code via serialization exploits in affected React and Next.js applications.

---

## Mitigation Actions Performed

### 1. Dependency Audit

Scanned `package.json` to identify installed versions and determine vulnerability exposure.

### 2. Package Upgrades

Upgraded all affected packages to patched versions using pnpm:

```bash
pnpm add react@latest react-dom@latest next@latest
pnpm add -D @types/react@latest @types/react-dom@latest eslint@latest eslint-config-next@latest
```

### 3. Build Validation

Executed production build to confirm compatibility:

```bash
pnpm run build
```

Build completed successfully after fixing one React 19 type compatibility issue.

### 4. Docker Remediation

Verified Dockerfile security configuration - already follows best practices.

---

## Files Changed

### `package.json`

Core dependencies upgraded:

| Package     | Before   | After    |
| ----------- | -------- | -------- |
| `react`     | ^18.3.1  | ^19.2.3  |
| `react-dom` | ^18.3.1  | ^19.2.3  |
| `next`      | ^14.2.15 | ^16.0.10 |

Dev dependencies upgraded for compatibility:

| Package              | Before   | After    |
| -------------------- | -------- | -------- |
| `@types/react`       | ^18.3.12 | ^19.2.7  |
| `@types/react-dom`   | ^18.3.1  | ^19.2.3  |
| `eslint`             | ^8.57.1  | ^9.39.2  |
| `eslint-config-next` | ^14.2.15 | ^16.0.10 |

### `pnpm-lock.yaml`

Lock file regenerated to reflect the updated dependency tree. This ensures:

- Exact versions are pinned for reproducible builds
- Transitive dependencies are updated to compatible versions
- No vulnerable packages remain in the dependency graph

### `tsconfig.json`

Automatically updated by Next.js 16 during build:

- `jsx` set to `react-jsx` (React automatic runtime)
- `target` set to `ES2017` (for top-level await support)
- `include` updated to add `.next/dev/types/**/*.ts`

### `src/hooks/usePushToTalk.ts`

Fixed React 19 type compatibility issue at line 101:

```diff
- targetRef: React.RefObject<HTMLElement>;
+ targetRef: React.RefObject<HTMLElement | null>;
```

React 19 enforces stricter typing for `RefObject` where `useRef<T>(null)` now returns `RefObject<T | null>` instead of `RefObject<T>`.

---

## Docker Remediation

### Dockerfile Security Assessment

The existing `Dockerfile` already implements security best practices:

```dockerfile
# Non-root user configuration (already present)
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs
USER nextjs
```

**Status:** No changes required.

### Required Action: Rebuild Image

To ensure the patched dependencies are included in the container image, rebuild without cache:

```bash
# Using docker-compose
docker-compose build --no-cache sync

# Or using docker directly
docker build --no-cache -t sync .
```

This forces a fresh dependency installation in the container, pulling the updated `pnpm-lock.yaml` dependencies.

---

## Verification Results

### Installed Versions (Post-Remediation)

```
sync@0.1.0
├── next@16.0.10
├── react-dom@19.2.3
└── react@19.2.3
```

### Build Output

```
▲ Next.js 16.0.10 (Turbopack)
✓ Compiled successfully in 4.1s
✓ Generating static pages (10/10) in 486.5ms
```

### Security Audit

```
pnpm audit
No known vulnerabilities found
```

---

## Summary

| Check                       | Status  |
| --------------------------- | ------- |
| Vulnerable versions removed | ✅ PASS |
| Safe versions installed     | ✅ PASS |
| Build validation            | ✅ PASS |
| Non-root container user     | ✅ PASS |
| pnpm audit clean            | ✅ PASS |

---

## Notes

- One type compatibility fix was required in `src/hooks/usePushToTalk.ts` for React 19's stricter `RefObject` typing
- Next.js 16 displays a deprecation warning about middleware → proxy convention (informational only, not blocking)
- The `tsconfig.json` was automatically updated by Next.js 16 with recommended settings

---

## References

- CVE-2025-55182 Advisory
- [Next.js Security Releases](https://nextjs.org/blog)
- [React Security Updates](https://react.dev/blog)
